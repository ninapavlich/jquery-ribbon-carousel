!function(a,b,c){function d(b,c){this.element=b,this.options=a.extend({},f,c),this.containers_inited=!1,this.slides_inited=!1,this.ready=!1,this.mobile_break=this.options.mobileBreak,this._defaults=f,this._name=e,this._original_slides=[],this.current_index=0,this.previous_index=0,this.previous_rendered_index=-1,this.dot_index=0,this.min_index=0,this.max_index=null,this.set_length=null,this.can_animate=!0,this.is_playing=!1,this.autoprogress_timeout=-1,this.slides_container=null,this.carousel_left=null,this.carousel_left_container=null,this.carousel_right=null,this.carousel_right_container=null,this.controls_container=null,this.carousel_pagination=null,this.carousel_arrows=null,this.init()}var e="ribbonCarousel",f={mobileBreak:767,autoPlay:!1,autoPlayInterval:5e3,containerWidthPortion:1,useAnchors:!1,pageAnchorPrefix:"slide",themeClass:"ribbon-carousel-theme-default"};d.prototype={init:function(){a(this.element).addClass("loading"),a(this.element).trigger("loading"),a(this.element).addClass(this.options.themeClass);if(0==this.containers_inited&&(this.containers_inited=!0,this.createContainers()),0==this.ready&&this._original_slides.length>=1&&(this.ready=!0),0==this.slides_inited&&(this.slides_inited=!0,this.startSlideQueue()),0!=this.ready){a(this.element).addClass("ready"),a(this.element).trigger("ready"),a(this.element).removeClass("loading"),this.setIsPlaying(1==this.options.autoPlay?!0:!1);var b=this.getIndexFromHash();b&&(this.current_index=b),this.resizeImages(),this.addListeners(),this.setIndex(this.current_index)}},createContainers:function(){this.original_slide_container=a(this.element).find("ul")[0],a('<div class="controls"><div class="container"></div></div>').insertBefore(this.original_slide_container),this.controls_container=a(this.element).find(".controls > .container"),a('<div class="slides"><div class="container"></div></div>').insertBefore(this.original_slide_container),this.slides_container=a(this.element).find(".slides > .container"),a(this.original_slide_container).css("display","none");var b="<ul class='carousel-arrows'><li><a href='#' class='next'><span>Next</span></a></li><li><a href='#' class='previous'><span>Previous</span></a></li></ul>",c="<ul class='carousel-play-pause'><li><a href='#play' class='play'><span>Play</span></a></li><li><a href='#pause' class='pause'><span>Pause</span></a></li></ul>",d="<ul class='carousel-pagination'></ul>";a(this.controls_container).append(a(d+b+c)),a(this.slides_container).append(a("<div class='carousel-left-container'><ul class='carousel-left'></ul></div>")),a(this.slides_container).append(a("<div class='carousel-center-container'><ul class='carousel-center'></ul></div>")),a(this.slides_container).append(a("<div class='carousel-right-container'><ul class='carousel-right'></ul></div>")),this.carousel_left=a(this.slides_container).find("ul.carousel-left")[0],this.carousel_left_container=a(this.element).find(".carousel-left-container")[0],this.carousel_center=a(this.slides_container).find("ul.carousel-center")[0],this.carousel_center_container=a(this.element).find(".carousel-center-container")[0],this.carousel_right=a(this.slides_container).find("ul.carousel-right")[0],this.carousel_right_container=a(this.element).find(".carousel-right-container")[0],this.carousel_pagination=a(this.controls_container).find("ul.carousel-pagination")[0],this.carousel_arrows=a(this.controls_container).find(".carousel-arrows")[0]},startSlideQueue:function(){var b=a(this.original_slide_container).find("li"),c=this._original_slides.length,d=a(b).length;if(d==c)a(this.element).trigger("done-loading");else{var e=b[c];this.addSlide(e,c)}},addSlide:function(a,b){b="undefined"==typeof b?this._original_slides.length:b,this.loadSlide(a,b,this.slideLoaded)},loadSlide:function(b,c,d){var e=this,f=a(b).find("img")[0],g=e.isImageMeasured(f);0==g&&a("<img/>").attr("src",a(f).attr("src")).load(function(){a(f).data("inited",!0),a(f).attr("data-inited",!0),a(f).data("image-width",this.width),a(f).attr("data-image-width",this.width),a(f).data("image-height",this.height),a(f).attr("data-image-height",this.height),d.call(e,b,c)})},slideLoaded:function(b,c){var d=a(b).clone();this._original_slides.push(d);var e="<li><a href='#"+this.options.pageAnchorPrefix+(c+1)+"'><span>Slide "+(c+1)+"</span></a></li>";a(this.controls_container).find(".carousel-pagination").append(e),this.set_length=this._original_slides.length,this.max_index=this.set_length-1,0==this.ready?this.init():this.setIndex(this.current_index,!0),this.startSlideQueue()},setIndex:function(b,c){return"undefined"==typeof c&&(c=!1),0==this.can_animate&&0==c?void(this.next_index=b):(this.previous_index=this.current_index,this.current_index=Math.max(Math.min(this.max_index,b),this.min_index),a(this.element).trigger("index_change",[this.current_index]),this.render(c),void this.setIsPlaying(this.is_playing))},setIsPlaying:function(b){if(this.is_playing!=b&&a(this.element).trigger("is_playing",[b]),this.is_playing=b,this.is_playing?(a(this.element).find(".controls a.pause").css("display","block"),a(this.element).find(".controls a.play").css("display","none")):(a(this.element).find(".controls a.pause").css("display","none"),a(this.element).find(".controls a.play").css("display","block")),this.is_playing&&this.set_length>1){var d=this;clearTimeout(this.autoprogress_timeout),this.autoprogress_timeout=setTimeout(function(){if(d.is_playing){var a=d.getIndexAfter(d.current_index);1==d.options.useAnchors?c.location.hash=d.options.pageAnchorPrefix+(a+1):d.setIndex(a)}},this.options.autoPlayInterval)}else 0==this.is_playing&&clearTimeout(this.autoprogress_timeout)},getIndexFromHash:function(a){"undefined"==typeof a&&(a=c.location.hash);var b=a.replace("#"+this.options.pageAnchorPrefix,""),d=parseInt(b);return isNaN(d)&&(d=0),d>0&&(d-=1),d},getImageListContainer:function(){return"UL"==a(this.element).prop("tagName")?this.element:a(this.element).find("ul").length>0?a(this.element).find("ul")[0]:this.element},render:function(b){"undefined"==typeof b&&(b=!1);var c=this,d=this.getImageColumnWidth(),e=(this.getContainerWidth(),b?0:400),f=this.getCenterIndexes(this.current_index,this.set_length),g=this.getRelativeIndexes(this.current_index,this.previous_index,this.set_length),h=g[0],i=g[1],j=i>h,k=j?h:i,l=Math.floor(f.length/2),m=0-d*l,n=j?m+k*d:m-k*d,o=m-d,p=n-d,q=this.previous_rendered_index!=this.current_index,r=this.previous_rendered_set_length!=this.set_length,s=q||r;s?(this.previous_rendered_set_length=this.set_length,this.setImages(f,this.carousel_center,!1),this.setImages(f,this.carousel_right,!1),this.setImages(f,this.carousel_left,!1),this.can_animate=!1,a(this.carousel_center).css("left",n+"px"),a(this.carousel_center).animate({left:m},e),a(this.carousel_right).css("left",p+"px"),a(this.carousel_right).animate({left:o},e),a(this.carousel_left).css("left",n+"px"),a(this.carousel_left).animate({left:m},e),this.can_animate=!1,setTimeout(function(){c.can_animate=!0},e+100),this.current_index!=this.previous_index&&a(this.carousel_pagination).find("li:nth-child("+(this.previous_index+1)+") a").removeClass("active"),a(this.carousel_pagination).find("li:nth-child("+(this.current_index+1)+") a").addClass("active"),this.reassignLinks(),this.resizeImages(),this.resizeContainers()):this.alignContainers(),this.previous_rendered_index=this.current_index},isImageMeasured:function(b){return a(b).data("inited")&&1==a(b).data("inited")?!0:"undefined"!=typeof a(b).data("image-width")&&"undefined"!=typeof a(b).data("image-width")?(a(b).data("inited",!0),!0):!1},alignContainers:function(){var b=this.getImageColumnWidth(),c=2*this.set_length-1,d=Math.floor(c/2),e=0-b*d,f=e-b;a(this.carousel_center).css("left",e+"px"),a(this.carousel_right).css("left",f+"px"),a(this.carousel_left).css("left",e+"px")},resizeContainers:function(){var b=this.getImageColumnWidth(),c=2*this.set_length-1,d=this.set_length*b,e=c*b;a(this.carousel_left).css("width",d),a(this.carousel_right).css("width",e),a(this.carousel_right_container).css("width",e),a(this.carousel_center).css("width",e)},resizeImages:function(){var b=this.getImageColumnWidth();a(this.element).find("ul.carousel-left > li").each(function(){a(this).width(b)}),a(this.element).find("ul.carousel-center > li").each(function(){a(this).width(b)}),a(this.element).find("ul.carousel-right > li").each(function(){a(this).width(b)}),this.resizeImageSet(a(this.element).find("ul.carousel-center > li, ul.carousel-left > li, ul.carousel-right > li"))},resizeImageSet:function(b){var c=this;a(b).each(function(){var b=a(this).find("img"),d=a(b).data("image-width"),e=a(b).data("image-height"),f=a(this).outerWidth(),g=a(this).outerHeight();c.imageFill(b,f,g,d,e)})},imageFill:function(b,c,d,e,f){var g=c/e,h=d/f;if(h>g){a(b).css("width","auto"),a(b).css("height",d+"px");var i=-.5*(e*h-c);a(b).css("margin-left",i+"px"),a(b).css("margin-top","0px")}else{a(b).css("height","auto"),a(b).css("width",c+"px");var j=-.5*(f*g-d);a(b).css("margin-top",j+"px"),a(b).css("margin-left","0px")}},getCenterIndexes:function(a,b){return this.getBeforeImageSet(a,b).concat([a]).concat(this.getAfterImageSet(a,b))},getAfterImageSet:function(a,b){for(var c=(a+1)%b,d=[],e=c;c+b-1>e;e++){var f=e%b;d.push(f)}return d},getBeforeImageSet:function(a,b){for(var c=(Math.floor((a+b)%b)+1)%b,d=[],e=c;c+b-1>e;e++){var f=e%b;d.push(f)}return d},reassignLinks:function(){this.set_length<2?a(this.controls_container).parent().addClass("disabled"):a(this.controls_container).parent().removeClass("disabled");var b=(this.current_index+1)%this.set_length,c=(this.current_index+this.set_length-1)%this.set_length,d="#"+this.options.pageAnchorPrefix+(b+1),e="#"+this.options.pageAnchorPrefix+(c+1);a(this.carousel_arrows).find(".next").attr("href",d),a(this.carousel_arrows).find(".previous").attr("href",e)},addListeners:function(){var c=this;a(this.element).find(".controls a").bind("click",function(b){switch(b.which){case 1:var d=a(this).attr("href");if(d.indexOf(c.options.pageAnchorPrefix)>=0){if(0==c.options.useAnchors){b.preventDefault(),b.defaultPrevented;var e=c.getIndexFromHash(d);c.setIndex(e)}}else"#play"==d?(b.preventDefault(),b.defaultPrevented,c.setIsPlaying(!0)):"#pause"==d&&(b.preventDefault(),b.defaultPrevented,c.setIsPlaying(!1))}}),a(b).bind("resize",function(){c.resizeImages(),c.resizeContainers(),c.alignContainers()}),a(b).bind("hashchange",function(){var a=c.getIndexFromHash();c.setIndex(a)})},addSlideListeners:function(b){var c=this,d=a(b).attr("data-slide");a(b).bind("click",function(a){d!=c.current_index&&(a.preventDefault(),a.defaultPrevented,c.setIndex(d))}),a(b).find("a").bind("click",function(a){d!=c.current_index&&(a.preventDefault(),a.defaultPrevented,c.setIndex(d))})},removeListeners:function(){a(this.element).find(".controls a").unbind("click")},removeSlideListeners:function(b){a(b).find("a").unbind("click"),a(b).unbind("click")},getImageColumnWidth:function(){var c=a(b).width();if(c<=this.mobile_break)return c;var d=a(this.slides_container).outerWidth();return d*this.options.containerWidthPortion},getContainerWidth:function(){var b=a(this.slides_container).outerWidth();return b},setImages:function(b,c,d){d&&console.log("indexes "+b);var e=this;a(c).children().each(function(a,b){e.removeSlide(b)});for(var f=0;f<b.length;f++)index=b[f],e.createSlide(index,c)},createSlide:function(b,c){var d=this._original_slides[b].clone();a(d).attr("data-slide",b),this.addSlideListeners(d),a(c).append(d)},removeSlide:function(b){this.removeSlideListeners(b),a(b).remove()},getRelativeIndexes:function(a,b,c){var d=Math.abs(b-a)%c,e=Math.abs(b+c-a)%c,f=Math.abs(b-(c+a))%c,g=(Math.abs(a-b)%c,Math.abs(c-(a-b))%c,a>=b?d:f),h=a>=b?e:e;return[g,h]},getIndexAfter:function(a){return(a+1)%this.set_length},getIndexBefore:function(a){return(a+this.set_length-1)%this.set_length}},a.fn[e]=function(b){return this.each(function(){a.data(this,"plugin_"+e)||a.data(this,"plugin_"+e,new d(this,b))})}}(jQuery,window,document);