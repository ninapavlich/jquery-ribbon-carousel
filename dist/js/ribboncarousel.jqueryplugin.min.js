!function(a,b,c){function d(b,c){this.element=b,this.options=a.extend({},f,c),this.containers_inited=!1,this.slides_inited=!1,this.ready=!1,this.mobile_break=this.options.mobileBreak,this._defaults=f,this._name=e,this._original_slides=[],this.attempted_index=0,this.current_index=0,this.previous_index=0,this.previous_rendered_index=-1,this.previous_rendered_platform=null,this.dot_index=0,this.min_index=0,this.max_index=null,this.set_length=null,this.can_animate=!0,this.loadedFromBeginning=!1,this.draggable_inited=!1,this.is_dragging=!1,this.drag_direction=0,this.start_drag_position=null,this.start_drag_position_left=null,this.start_drag_position_right=null,this.stop_drag_position=null,this.stop_drag_position_left=null,this.stop_drag_position_right=null,this.drag_timeout=null,this.is_playing=!1,this.autoprogress_timeout=-1,this.current_autoplay_interval=0,this.average_aspect_ratio=1.6,this.aspect_ratio=this.average_aspect_ratio,this.slides_container=null,this.carousel_left=null,this.carousel_left_container=null,this.carousel_right=null,this.carousel_right_container=null,this.controls_container=null,this.carousel_pagination=null,this.carousel_arrows=null,this.init()}var e="ribbonCarousel",f={mobileBreak:767,autoPlay:!1,autoPlayInterval:5e3,maxAutoPlayIntervals:0,containerWidthPortion:1,useAnchors:!1,pageAnchorPrefix:"slide",themeClass:"ribbon-carousel-theme-default",aspectRatio:null};d.prototype={init:function(){a(this.element).addClass("loading"),a(this.element).trigger("loading"),a(this.element).addClass(this.options.themeClass),this.starting_loading_index=1==this.options.useAnchors?this.getIndexFromHash(b.location.hash):0;0==this.containers_inited&&(this.containers_inited=!0,this.createContainers()),0==this.ready&&this._original_slides.length>=1&&(this.ready=!0),0==this.slides_inited&&(this.slides_inited=!0,this.startSlideQueue()),0!=this.ready&&(a(this.element).addClass("ready"),a(this.element).trigger("ready"),a(this.element).removeClass("loading"),this.setIsPlaying(1==this.options.autoPlay?!0:!1),this.attempted_index=this.current_index=this.starting_loading_index,this.resizeImages(),this.addListeners(),this.setIndex(this.current_index))},createContainers:function(){this.original_slide_container=a(this.element).find("ul")[0],a('<div class="controls"><div class="container"></div></div>').insertBefore(this.original_slide_container),this.controls_container=a(this.element).find(".controls > .container"),a('<div class="slides"><div class="container"></div></div>').insertBefore(this.original_slide_container),this.slides_container=a(this.element).find(".slides > .container"),a(this.original_slide_container).css("display","none");var b="<ul class='carousel-arrows'><li><a href='#' class='next'><span>Next</span></a></li><li><a href='#' class='previous'><span>Previous</span></a></li></ul>",c="<ul class='carousel-play-pause'><li><a href='#play' class='play'><span>Play</span></a></li><li><a href='#pause' class='pause'><span>Pause</span></a></li></ul>",d="<ul class='carousel-pagination'></ul>";a(this.controls_container).append(a(d+b+c)),a(this.slides_container).append(a("<div class='carousel-left-container'><ul class='carousel-left'></ul></div>")),a(this.slides_container).append(a("<div class='carousel-center-container'><ul class='carousel-center'></ul></div>")),a(this.slides_container).append(a("<div class='carousel-right-container'><ul class='carousel-right'></ul></div>")),this.carousel_left=a(this.slides_container).find("ul.carousel-left")[0],this.carousel_left_container=a(this.element).find(".carousel-left-container")[0],this.carousel_center=a(this.slides_container).find("ul.carousel-center")[0],this.carousel_center_container=a(this.element).find(".carousel-center-container")[0],this.carousel_right=a(this.slides_container).find("ul.carousel-right")[0],this.carousel_right_container=a(this.element).find(".carousel-right-container")[0],this.carousel_pagination=a(this.controls_container).find("ul.carousel-pagination")[0],this.carousel_arrows=a(this.controls_container).find(".carousel-arrows")[0]},startSlideQueue:function(){var b=a(this.original_slide_container).find("li"),c=this._original_slides.length,d=a(b).length;if(d==c)a(this.element).trigger("done-loading"),this.addPaginationListeners();else{var e=this.getNextSlideLoadIndex(),f=b[e];this.addSlide(f,e)}this.initDraggable()},getNextSlideLoadIndex:function(){var b=a(this.original_slide_container).find("li"),c=a(b).length,d=this._original_slides.length;if(1==this.loadedFromBeginning)var e=c-(d+1)/2;else var e=d/2;this.loadedFromBeginning=!this.loadedFromBeginning;var f=(this.starting_loading_index+e)%c;return f},addSlide:function(a,b){b="undefined"==typeof b?this._original_slides.length:b,this.loadSlide(a,b,this.slideLoaded)},loadSlide:function(b,c,d){var e=this,f=a(b).find("img")[0],g=e.isImageMeasured(f);if(0==g){var h=e.getImageSrc(f);a(f).attr("src",h),a("<img/>").attr("src",h).load(function(){a(f).data("inited",!0),a(f).attr("data-inited",!0);var g=this.width/this.height;a(f).data("image-aspect-ratio",g),a(f).attr("data-image-aspect-ratio",g),a(b).data("index",c),a(b).attr("data-index",c),d.call(e,b,c)})}},getImageSrc:function(b){return a(b).attr(this.isMobile()?"data-mobile":"data-desktop")},slideLoaded:function(b,c){var d=a(b).clone();this._original_slides.push(d),this._original_slides.sort(function(b,c){var d=parseInt(a(b).attr("data-index")),e=parseInt(a(c).attr("data-index"));return e>d?-1:d>e?1:0});var e="<li><a href='#'><span>Slide "+(c+1)+"</span></a></li>";a(this.controls_container).find(".carousel-pagination").append(e),this.set_length=this._original_slides.length,this.max_index=this.set_length-1,this.average_aspect_ratio=this.calculateAverageAspectRatio(),this.aspect_ratio=null==this.options.aspectRatio?this.average_aspect_ratio:this.options.aspectRatio,0==this.ready?this.init():this.setIndex(this.attempted_index,!0),this.startSlideQueue()},setIndex:function(b,c){return"undefined"==typeof c&&(c=!1),0==this.can_animate&&0==c?void(this.next_index=b):(this.previous_index=this.current_index,this.attempted_index=b,this.current_index=Math.max(Math.min(this.max_index,b),this.min_index),a(this.element).trigger("index_change",[this.current_index]),this.render(c),void this.setIsPlaying(this.is_playing))},getNextSlideIndex:function(){return(this.current_index+1)%this.set_length},getPreviousSlideIndex:function(){return(this.current_index+this.set_length-1)%this.set_length},setIsPlaying:function(b){var d=this;if(this.is_playing!=b&&(a(this.element).trigger("is_playing",[b]),this.current_autoplay_interval=0),this.is_playing=b,this.is_playing?(a(this.element).find(".controls a.pause").css("display","block"),a(this.element).find(".controls a.play").css("display","none")):(a(this.element).find(".controls a.pause").css("display","none"),a(this.element).find(".controls a.play").css("display","block")),this.is_playing&&this.set_length>1){clearTimeout(this.autoprogress_timeout);var e=this.options.maxAutoPlayIntervals<=0||this.set_length*this.options.maxAutoPlayIntervals>this.current_autoplay_interval;e&&(this.autoprogress_timeout=setTimeout(function(){if(d.current_autoplay_interval+=1,d.is_playing){var a=d.getIndexAfter(d.current_index);1==d.options.useAnchors?c.location.hash=d.options.pageAnchorPrefix+(a+1):d.setIndex(a)}},this.options.autoPlayInterval))}else 0==this.is_playing&&clearTimeout(this.autoprogress_timeout)},getIndexFromHash:function(a){if("undefined"==typeof a&&(a=c.location.hash),""==a)return 0;var b=a.replace("#"+this.options.pageAnchorPrefix,""),d=parseInt(b);return isNaN(d)&&(d=0),d>0&&(d-=1),d},getImageListContainer:function(){return"UL"==a(this.element).prop("tagName")?this.element:a(this.element).find("ul").length>0?a(this.element).find("ul")[0]:this.element},render:function(b){"undefined"==typeof b&&(b=!1);var c=this,d=this.getImageColumnWidth(),e=(this.getContainerWidth(),b?0:400),f=this.getCenterIndexes(this.current_index,this.set_length),g=this.getRelativeIndexes(this.current_index,this.previous_index,this.set_length),h=g[0],i=g[1],j=i>h,k=j?h:i,l=Math.floor(f.length/2),m=0-d*l,n=null!=this.stop_drag_position?j?this.stop_drag_position+d:this.stop_drag_position-d:j?m+k*d:m-k*d,o=m-d,p=n-d,q=this.isMobile(),r=q?"mobile":"desktop",s=this.previous_rendered_index!=this.current_index,t=this.previous_rendered_set_length!=this.set_length,u=this.previous_rendered_platform!=r,v=s||t||u;if(v){this.previous_rendered_set_length=this.set_length,this.previous_rendered_platform=r,this.setImages(f,this.carousel_center,!1),this.isMobile()?(this.setImages([],this.carousel_right,!1),this.setImages([],this.carousel_left,!1)):(this.setImages(f,this.carousel_right,!1),this.setImages(f,this.carousel_left,!1)),this.can_animate=!1;var w=Math.abs(n-m),x=(Math.min(1,w/d),e);a(this.carousel_center).css("left",n+"px"),a(this.carousel_center).animate({left:m},x),a(this.carousel_right).css("left",p+"px"),a(this.carousel_right).animate({left:o},x),a(this.carousel_left).css("left",n+"px"),a(this.carousel_left).animate({left:m},x),this.can_animate=!1,setTimeout(function(){c.can_animate=!0},x+100),this.current_index!=this.previous_index&&a(this.carousel_pagination).find("li:nth-child("+(this.previous_index+1)+") a").removeClass("active"),a(this.carousel_pagination).find("li:nth-child("+(this.current_index+1)+") a").addClass("active"),this.reassignLinks(),this.resizeImages(),this.resizeContainers()}else this.alignContainers();this.previous_rendered_index=this.current_index,this.stop_drag_position=null},isImageMeasured:function(b){return a(b).data("inited")&&1==a(b).data("inited")?!0:"undefined"!=typeof a(b).data("image-aspect-ratio")&&"undefined"!=typeof a(b).data("image-aspect-ratio")?(a(b).data("inited",!0),!0):!1},alignContainers:function(){var b=this.getImageColumnWidth(),c=2*this.set_length-1,d=Math.floor(c/2),e=0-b*d,f=e-b;a(this.carousel_center).css("left",e+"px"),a(this.carousel_right).css("left",f+"px"),a(this.carousel_left).css("left",e+"px")},resizeContainers:function(){var b=this.getImageColumnWidth(),c=2*this.set_length-1,d=this.set_length*b,e=c*b;a(this.carousel_left).css("width",d),a(this.carousel_right).css("width",e),a(this.carousel_right_container).css("width",e),a(this.carousel_center).css("width",e)},resizeImages:function(){var b=this.getImageColumnWidth(),c=Math.round(b/this.aspect_ratio),d=Math.round(.5*c);a(this.element).css("height",c),a(this.element).find(".carousel-arrows").css("top",d),a(this.element).find(".carousel-pagination").css("top",c),a(this.element).find(".carousel-play-pause").css("top",c),a(this.element).find("ul.carousel-left > li").each(function(){a(this).width(b)}),a(this.element).find("ul.carousel-center > li").each(function(){a(this).width(b)}),a(this.element).find("ul.carousel-right > li").each(function(){a(this).width(b)}),this.resizeImageSet(a(this.element).find("ul.carousel-center > li, ul.carousel-left > li, ul.carousel-right > li"))},resizeImageSet:function(b){var c=this;a(b).each(function(){var b=a(this).find("img"),d=c.getImageSrc(b);a(b).attr("src",d);var e=a(b).data("image-aspect-ratio"),f=a(this).outerWidth(),g=a(this).outerHeight();c.imageFill(b,f,g,e)})},imageFill:function(b,c,d,e){var f=c/d;if(e>f){a(b).css("width","auto"),a(b).css("height",d+"px");var g=e*d,h=-.5*(g-c);a(b).css("margin-left",h+"px"),a(b).css("margin-top","0px")}else{a(b).css("height","auto"),a(b).css("width",c+"px");var i=c/e,j=-.5*(i-d);a(b).css("margin-top",j+"px"),a(b).css("margin-left","0px")}},getCenterIndexes:function(a,b){return this.getBeforeImageSet(a,b).concat([a]).concat(this.getAfterImageSet(a,b))},getAfterImageSet:function(a,b){for(var c=(a+1)%b,d=[],e=c;c+b-1>e;e++){var f=e%b;d.push(f)}return d},getBeforeImageSet:function(a,b){for(var c=(Math.floor((a+b)%b)+1)%b,d=[],e=c;c+b-1>e;e++){var f=e%b;d.push(f)}return d},reassignLinks:function(){this.set_length<2?a(this.controls_container).parent().addClass("disabled"):a(this.controls_container).parent().removeClass("disabled");var b=this.getNextSlideIndex(),c=this.getPreviousSlideIndex(),d="#"+this.options.pageAnchorPrefix+(b+1),e="#"+this.options.pageAnchorPrefix+(c+1);a(this.carousel_arrows).find(".next").attr("href",d),a(this.carousel_arrows).find(".previous").attr("href",e);var f=this;a(this.controls_container).find(".carousel-pagination li").each(function(b,c){var d="#"+f.options.pageAnchorPrefix+(b+1);a(c).find("a").attr("href",d)})},addListeners:function(){var c=this;a(this.element).find(".controls a").bind("click",function(a){c.controlLinkClicked(a,this)}),a(b).bind("resize",function(){c.resizeImages(),c.resizeContainers(),c.alignContainers(),c.render()}),a(b).bind("hashchange",function(){var a=c.getIndexFromHash();c.setIndex(a)})},addPaginationListeners:function(){var b=this;a(this.controls_container).find(".carousel-pagination").find("a").bind("click",function(a){b.controlLinkClicked(a,this)})},controlLinkClicked:function(b,c){switch(b.which){case 1:var d=a(c).attr("href");if(d.indexOf(this.options.pageAnchorPrefix)>=0){if(0==this.options.useAnchors){b.preventDefault(),b.defaultPrevented;var e=this.getIndexFromHash(d);this.setIndex(e)}}else"#play"==d?(b.preventDefault(),b.defaultPrevented,this.setIsPlaying(!0)):"#pause"==d&&(b.preventDefault(),b.defaultPrevented,this.setIsPlaying(!1))}},addSlideListeners:function(b){var c=this,d=a(b).attr("data-slide");a(b).bind("click",function(a){d!=c.current_index&&(a.preventDefault(),a.defaultPrevented,c.setIndex(d))}),a(b).find("a").bind("click",function(a){d!=c.current_index&&(a.preventDefault(),a.defaultPrevented,c.setIndex(d))})},removeListeners:function(){a(this.element).find(".controls a").unbind("click")},removeSlideListeners:function(b){a(b).find("a").unbind("click"),a(b).unbind("click")},getImageColumnWidth:function(){var c=a(b).width();if(c<=this.mobile_break)return c;var d=a(this.slides_container).outerWidth();return d*this.options.containerWidthPortion},calculateAverageAspectRatio:function(){var b=a(this.element).find("ul.carousel-center > li"),c=0;return a(b).each(function(){var b=a(this).find("img"),d=parseFloat(a(b).data("image-aspect-ratio"));c+=d}),c/b.length},getContainerWidth:function(){var b=a(this.slides_container).outerWidth();return b},setImages:function(b,c,d){d&&console.log("indexes "+b);var e=this;a(c).children().each(function(a,b){e.removeSlide(b)});for(var f=0;f<b.length;f++)index=b[f],e.createSlide(index,c)},createSlide:function(b,c){var d=this._original_slides[b].clone();a(d).attr("data-slide",b),this.addSlideListeners(d),a(c).append(d)},removeSlide:function(b){this.removeSlideListeners(b),a(b).remove()},getRelativeIndexes:function(a,b,c){var d=Math.abs(b-a)%c,e=Math.abs(b+c-a)%c,f=Math.abs(b-(c+a))%c,g=(Math.abs(a-b)%c,Math.abs(c-(a-b))%c,a>=b?d:f),h=a>=b?e:e;return[g,h]},getIndexAfter:function(a){return(a+1)%this.set_length},getIndexBefore:function(a){return(a+this.set_length-1)%this.set_length},isMobile:function(){var a=this.getImageColumnWidth();return a<=this.mobile_break},initDraggable:function(){if(1!=this.draggable_inited){this.carousel_center;try{a(this.carousel_center).draggable("destroy")}catch(b){}a(this.carousel_center).draggable({snap:!1,axis:"x"});var c=this;a(this.carousel_center).bind("dragstart",function(){c.onDragStart()}),a(this.carousel_center).bind("drag",function(){c.onDrag()}),a(this.carousel_center).bind("dragstop",function(){c.onDragStop()}),this.draggable_inited=!0}},onDragStart:function(){this.is_dragging=!0,this.start_drag_position=parseInt(a(this.carousel_center).css("left")),this.start_drag_position_left=parseInt(a(this.carousel_left).css("left")),this.start_drag_position_right=parseInt(a(this.carousel_right).css("left")),clearTimeout(this.drag_timeout)},onDrag:function(){var b=parseInt(a(this.carousel_center).css("left")),c=this.start_drag_position-b;this.drag_direction=Math.abs(c)/c,a(this.carousel_left).css("left",this.start_drag_position_left-c),a(this.carousel_right).css("left",this.start_drag_position_right-c)},onDragStop:function(){var b=this.current_index;this.stop_drag_position=parseInt(a(this.carousel_center).css("left")),this.stop_drag_position_left=parseInt(a(this.carousel_left).css("left")),this.stop_drag_position_right=parseInt(a(this.carousel_right).css("left")),b=this.drag_direction>0?this.getNextSlideIndex():this.getPreviousSlideIndex(),1==this.options.useAnchors?c.location.hash=this.options.pageAnchorPrefix+(b+1):this.setIndex(b);var d=this;this.drag_timeout=setTimeout(function(){d.is_dragging=!1},100)}},a.fn[e]=function(b){return this.each(function(){a.data(this,"plugin_"+e)||a.data(this,"plugin_"+e,new d(this,b))})}}(jQuery,window,document);